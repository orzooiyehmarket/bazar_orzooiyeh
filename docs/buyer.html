<!DOCTYPE html><html lang="fa">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>لیست محصولات - بازار ارزوئیه</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f9f9f9;
      padding: 1rem;
      direction: rtl;
    }
    h1 {
      text-align: center;
      color: #2c3e50;
    }
    .controls {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }
    input, select {
      padding: 0.5rem;
      font-size: 1rem;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    .product-list {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .product {
      background: white;
      padding: 1rem;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }
    .product h2 {
      margin: 0 0 0.5rem 0;
    }
    .product p {
      margin: 0.25rem 0;
    }
  </style>
</head>
<body>
  <h1>لیست محصولات بازار ارزوئیه</h1>
  <div class="controls">
    <input type="text" id="searchInput" placeholder="جستجو بر اساس نام محصول">
    <select id="categoryFilter">
      <option value="">همه دسته‌بندی‌ها</option>
    </select>
  </div>
  <div class="product-list" id="productList"></div>  <script>
    const SHEET_ID = 'YOUR_SHEET_ID';
    const SHEET_NAME = 'Sheet1';
    const API_KEY = 'YOUR_API_KEY';

    const searchInput = document.getElementById('searchInput');
    const categoryFilter = document.getElementById('categoryFilter');
    const productList = document.getElementById('productList');

    let products = [];

    async function fetchData() {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;
      try {
        const response = await fetch(url);
        const data = await response.json();
        const rows = data.values;
        const headers = rows[0];
        products = rows.slice(1).map(row => {
          let product = {};
          headers.forEach((header, index) => {
            product[header] = row[index];
          });
          return product;
        });
        populateCategoryFilter();
        displayProducts();
      } catch (error) {
        console.error('خطا در بارگذاری داده‌ها:', error);
        productList.innerHTML = '<p>خطا در بارگذاری داده‌ها.</p>';
      }
    }

    function populateCategoryFilter() {
      const categories = [...new Set(products.map(p => p.category))];
      categories.forEach(category => {
        const option = document.createElement('option');
        option.value = category;
        option.textContent = category;
        categoryFilter.appendChild(option);
      });
    }

    function displayProducts() {
      const searchTerm = searchInput.value.toLowerCase();
      const selectedCategory = categoryFilter.value;
      const filteredProducts = products.filter(product => {
        const matchesSearch = product.product.toLowerCase().includes(searchTerm);
        const matchesCategory = selectedCategory ? product.category === selectedCategory : true;
        return matchesSearch && matchesCategory;
      });

      productList.innerHTML = '';
      if (filteredProducts.length === 0) {
        productList.innerHTML = '<p>محصولی یافت نشد.</p>';
        return;
      }

      filteredProducts.forEach(product => {
        const productDiv = document.createElement('div');
        productDiv.className = 'product';
        productDiv.innerHTML = `
          <h2>${product.product}</h2>
          <p>قیمت: ${product.price} تومان</p>
          <p>موجودی: ${product.quantity}</p>
          <p>دسته‌بندی: ${product.category}</p>
          <p>فروشنده: ${product.name}</p>
          <p>شماره تماس: ${product.phone}</p>
        `;
        productList.appendChild(productDiv);
      });
    }

    searchInput.addEventListener('input', displayProducts);
    categoryFilter.addEventListener('change', displayProducts);

    fetchData();
  </script></body>
</html>
